<!-- BeginDsi "dsi/head.html" -->
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Embedthis Appweb 4.6.5 Documentation</title>
    <meta name="keywords" content="embedded web server, web server software, embedded HTTP, application web server, 
        embedded server, small web server, HTTP server, library web server, library HTTP, HTTP library" />
    <meta name="description" content="Embedthis Sofware provides commercial and open source embedded web servers for 
        devices and applications." />
	<meta name="robots" content="index,follow" />
	<link href="../../../doc.css" rel="stylesheet" type="text/css" />
	<link href="../../../print.css" rel="stylesheet" type="text/css" media="print"/>
    <!--[if IE]>
    <link href="../../../iehacks.css" rel="stylesheet" type="text/css" />
    <![endif]-->
</head>

<body>
    <div class="top">
        <a class="logo" href="http://appwebserver.org/">&nbsp;</a>
        <div class="topRight">
            <div class="search">
                <div id="cse-search-form"></div>
                <div class="version">Embedthis Appweb 4.6.5</div>
            </div>
        </div>
        <div class="crumbs">
            <a href="../../../index.html">Home</a>
<!-- EndDsi -->
             &gt;<a href="index.html">ESP Guide</a> &gt; <b>Embedded Server for Angular</b>
        </div>
    </div>
    <div class="content">
        <div class="contentRight">
            <h1>Quick Nav</h1>
            <ul class="nav">
                <li><a href="#handler">ESP Handler</a></li>
                <li><a href="#api">ESP API</a></li>
            </ul>
<!-- BeginDsi "dsi/webFrameSeeAlso.html" -->
            <h1>See Also</h1>
            <ul class="nav">
                <li><a href="../../../guide/appweb/users/frameworks.html">Web Frameworks</a></li>
                <li><a href="../../../guide/appweb/users/action.html">Action Handler</a></li>
                <li><a href="../../../guide/appweb/users/cgi.html">CGI</a></li>
                <li><a href="../../../guide/esp/users/index.html">ESP</a></li>
                <li><a href="../../../guide/appweb/users/ejs.html">Ejscript</a></li>
                <li><a href="../../../guide/appweb/users/php.html">PHP</a></li>
                <li><a href="../../../guide/appweb/users/index.html">User Guide Overview</a></li>
                <li><a href="../../../guide/appweb/users/configuration.html">Configuring Appweb</a></li>
                <li><a href="../../../guide/appweb/users/ports.html">Ports and Binding</a></li>
                <li><a href="../../../guide/appweb/users/authentication.html">User Authorization</a></li>
                <li><a href="../../../guide/appweb/users/logFiles.html">Log Files</a></li>
                <li><a href="../../../guide/appweb/users/vhosts.html">Virtual Hosts</a></li>
                <li><a href="../../../guide/appweb/users/security.html">Security Considerations</a></li>
                <li><a href="../../../guide/appweb/users/ssl.html">SSL</a></li>
                <li><a href="../../../guide/appweb/users/modules.html">Appweb Modules</a></li>
                <li><a href="../../../guide/appweb/users/stages.html">Pipeline Stages</a></li>
                <li><a href="../../../guide/appweb/users/client.html">HTTP Client</a></li>
                <li><a href="../../../ref/appweb/architecture.html">Appweb Architecture</a></li>
            </ul>
<!-- EndDsi -->
        </div>
        <div class="contentLeft">
            <h1>Embedded Server Pages for Angular</h1>
            <p>Angular is a client-side web framework designed for single web page applications that is well-suited for
            creating dynamic management applications. ESP support Angular by providing an Angular component for the
            esp generator and a script library to support and extend Angular for ESP.</p>
            <h2>Why Angular?</h2>
            <p>Why use a client-side framework like Angular?  Why not just generate HTML at the web server?
            The answer is a better user experience. By using a framework such as Angular, you can create a faster,
            more responsive, more dynamic user interface. This is because it creates dynamically creates the user 
            views at the client. This reduces or eliminates the typical page reload wait times if all views are 
            rendered at the server.</p>
            <p>There are may client-side web frameworks to choose from, but Angular offers one of the more powerful
            framworks that requires very little coding to express and manage user interfaces. </p>
            <img class="big-screen" src="../../../images/esp/angular/kickstart.png" />
            <p>This screen shot is of the Embedthis Kickstart interface that was created using Appweb and ESP Angular.</p>
            <h2>Understanding Angular</h2>
            <p>Angular is a powerful client-side framework and it will take some time to learn and understand it
            sufficiently to use with Appweb/ESP. It is important to familiar with the key Angular concepts and 
            to create some stand-alone Angular applications before using with ESP. Please see and read the
            Angular resources listed below.</p>
            <h2>Distributed MVC</h2>
            <p>When using a client-side, single-page architecture (SPA) framework like Angular, the traditional 
            Model-View-Controller paradigm becomes distributed or spread-out over both the server and the client.
            Both client and server run MVC stacks, but each side emphasises different parts of the MVC paradigm.</p>
            <p>At the server, application data and server-side data models are stored. Server controllers
            receive client requests, validate request data and access data models as required. Responses are typically
            sent in JSON format.</p>
            <p>On the client side, a simple data model receives and stores server data. Client side controllers manage
            the client interaction and response data for the presentation views. View templates are dynamically 
            created and populated with server data before being and applied to the brower DOM for display.</p>
            <h2>Generating Applications</h2>
            <p>The easiest way to get started with ESP for Angular is to use the <em>esp</em> generator program,
            but first you need to download the esp-angular-mvc package from the 
            <a href="https://embedthis.com/catalog/#/?keywords=esp">Pak Catalog</a> using
            <a href="http://embedthis.com/products/pak/">Pak</a>.
            The following sequence will generate an application with ESP for Angular support.</p>
            <pre>
mkdir myapp
cd myapp
pak cache esp-angular-mvc
esp install esp-angular-mvc</pre>
            <p>Once generated, you can generate controllers, scaffolds or database migrations. For example:
            <pre>cd myapp
esp generate scaffold blog title:string body:text</pre>
            <p>This will generate a MVC scaffold with basic Create/Read/Update/Delete (CRUD) 
            operations, database table, controller and views for "blog" resource.</p>
            <h2>Application Structure</h2>
            <p>ESP for Angular uses a standard directory layout to structure your application. While this can be
            modified to suit custom needs, the standard structure scales well to suit most needs. The approach
            can be broadly called "organize by feature". Rather than group all views together and similarly with
            models, services and controllers, ESP organizes the application by feature so that the view, controller
            and data model for a given feature are together in one place. This approach scales better as the
            application grows. 
            <h3>Directory Layout</h3>
            <p>If you use the <em>esp</em> generator to create your application, the default ESP organization is generated for you. Directories are created for client-side code and assets as well as directories for 
            server-side controllers and database assets.</p>
            <p>The <em>client</em> directory is the set of public files that are served to the client. This directory
            represents the top of the application. Everything under the <em>client</em> directory is visiable to 
            the client. So do not put private information such as passwords or keys anywhere under the client
            directory.</p>
            <p>The key directories and files are listed below:</p>
<pre>
appweb.conf                 # Appweb configuration file
package.json                # ESP and application configuration file
start.me                    # MakeMe build file
cache/                      # Compiled code
client/                     # Public files served to the client
    app/                    # Application features
        main.js             # Main application script
        main.js             # Main application script
        name/               # Single (named) application feature
            name.js         # Feature database MVC model
            nameControl.js  # Feature MVC controller
            name-edit.html  # Edit view HTML partial page
            name-list.html  # List view HTML partial page
            ...
    assets/                 # Media assets. Images, audio, video
        favicon.ico
    css/                    # Style sheets and Less sheets
        all.less            # Top level less sheet that includes all others
        app.less            # Application specific styles
        theme.less          # Application theme variables
    index.esp               # Application home page
    lib/                    # Third party components
controllers/                # Server-side "C" controllers
    name.c                  # Server controller for feature "name"
db/                         # Database files
    migrations              # Database migration "C" scripts
src/                        # Other application "C" code
    app.c                   # Application global code
</pre>
            <p>To change default directories, use the 
                <a href="../../appweb/users/dir/esp.html#espDir">EspDir</a> configuration directive. For example:
                <pre>&lt;EspApp name="myapp" routes="esp-angular-mvc"&gt;
    EspDir cache /var/spool/cache/myapp
&lt;/EspApp&gt;</pre>
            <h2>Building</h2>
            <p>An ESP for Angular application is represented by five groups of resources:</p>
                <ol>
                    <li>HTML pages</li>
                    <li>Scripts</li>
                    <li>Style sheets</li>
                    <li>C Code</li>
                    <li>Media assets</li>
                </ol>
            <p>In a typical application, these resources may number in the hundereds. If they 
            were served individually, either the initial startup time would be slow, or the 
            per-page transition would be slow. ESP for Angular optimizes this by compiling 
            HTML pages into Javascript and then combining with all other all scripts into a single,
             minified, compressed script file. Similarly, CSS and Less sheets are aggregated, 
            minified, and compressed into a single file. Further, the C code can be "combined" 
            into one source file which is compiled into a single binary. The end result is a 
            highly optimized application that starts quickly and transitions from view to view 
            without delay.</p>
            <h2>Components</h2>
            <p>ESP for Angular depends on a suite of contributing components to achieve its magic. 
            These components are:</p>
            <ul>
                <li>Server &mdash; Core ESP Angular server-side structure</li>
                <li>Angular &mdash; AngularJS libraries </li>
                <li>Angular-esp &mdash; ESP for Angular services, directives and scripts</li>
                <li>less &mdash; The <a href="lesscss.org">Less</a> dynamic stylesheet language</a></li>
                <li>more &mdash; Polyfill for newer HTML5 elements</li>
                <li>esp-angular-mvc &mdash; ESP for Angular definition and templates </li>
            </ul>
            <h2>Client / Server Request Protocol</h2>
            <p>Between the client and server, the typical exchange of HTML pages, style sheets, scripts and media takes
            place. However with ESP and Angular, this occurs mostly at the start of the application. Thereafter, 
            requsts are received from the client and responses are sent in 
            <a href="http://en.wikipedia.org/wiki/JSON">JSON</a> format.
            While additional HTML, scripts, style sheets and medai may be provided to the client in HTML format, 
            the vast bulk of the traffic is pure JSON. 
            This makes the application more efficient and responsive as there are fewer requests to the server
            and the responses are typically much more compact.</p>
            <h3>Request Data</h3>
            <p>Requests supply parameters via a POST body encoded in JSON. If the request is from a HTML form, the
                form parameters are mapped to corresponding JSON property names. Otherwise, the client if free to
                format the JSON body as it wishes.</p>
            <h3>Response Data</h3>
            <p>ESP controllers are free to use any response format they wish. However, some convenience APIs
            follow a specific JSON encoding format that supplies data, schema and out-of-band feedback to the client.
            This format is called the ESP JSON response format. For example:
            <pre>
{
    error: 1,
    feedback: {
        error: "Post not created",
    },
    fieldErrors: {
        "field-1": "User name not unique"
    },
    data: {
        id: "23",
        "name": "John",
    },
    schema: {
        "types": {
            "name": {
                type: "string",
            },
        },
        columns: [ "name", ...]
    },
}
</pre>
            <p>The top-level properties are:
            <ul>
                <li>error &mdash; Numeric error code. Set to 0 for success.</li>
                <li>feedback &mdash; Colllection of feedback messages. Typical keys are: "inform", "error" and 
                    "warning".</li>
                <li>fieldErrors &mdash; Collection of field validation errors. Each key is the name of a record field.
                    The field value is the error message.
                <li>data &mdash; Simple record object or array of records. All data are sent as strings.
                <li>schema &mdash; Database schema for the record data. Includes properties "types" for field data types.
                    The valid types are "int", "boolean", "string", "number". The 
                    "columns" field holds the names of the record columns (excluding "id").</li>
            </ul>
            <h2>Configuring ESP</h2>
            <p>In addition to the standard package.json configuration fields 
            (see <a href="config.html#json">Esp Configuration File</a> for details), ESP for Angular defines 
            a few properties to assist with configuration. 
<pre>
{
    settingss: {
        formats: {
            date: 'yyyy-MM-dd',
            float: 2,               # Show two decimal places
        },
        json: true,
    }
}
</pre>
                <p>The <em>formats</em> collection defines default data presentation formats to be used in the absense
                of explicit view instructions. The <em>json</em> property instructs ESP to send all error messages
                via JSON in the "feedback" channel.</p>
            <h3>Development and Product Modes</h3>
            <p>The <em>settings.debug</em> property selects the <em>debug</em> or <em>release</em> collection of properties
            to be copied to <em>settings</em>. The debug/release collection has by default the following properties:
<pre>
debug: {
    combined: false,    # Run in combined vs discrete mode
    showErrors: true,   # Show debug errors in the client browser
    keepSource: true,   # Keep intermediate source in "cache"
    update: true,       # Dynamically reload modified code
    login: {
        name: "",       # Auto-login by this user name
        abilities: {    # User abilities 
            edit: true,
            view: true,
        },
    },
},
</pre>
                <p>You can also add your own properties to debug and release.</p>
                <p>The <em>login property</em> permits you to specify a user-name that will be used to automatically
                login the client with the specified abilities. This is useful for debug to bypass a mandatory login
                dialog.</p>
            <h2>ESP Angular Services, Directives and Filters</h2>
            <p>ESP Angular provides a suite of Angular services, directives and filters
            to tightly integrate ESP and Angular and facilitate smooth, easy, communications between the two. 
            See the <a href="../../../api/esp-angular/index.html">ESP Angular API</a> for API specifics.</p>
            <h3>Esp Service</h3>
            <p>The Esp object provides utility function and state services that may be accessed directly from the Esp 
            object. The Esp service also performs background activities to smooth the execution of Esp 
            applications. Specifically: </p>
            <ul>
                <li>The Esp service will track the browser referrer and store it in Esp.referrer.</li>
                <li>The Esp service will assist in managing the user feedback service from the server-side controller. Whenever a browser click event is received the transient feedback message area will be cleared.</li>
                <li>The Esp service will manage client side sessions. While the ultimate arbiter of user sessions is done on the server side, the Esp service will mirror a client side understanding of the server side service. The Esp service will warn the user when a session is about to expire and will provide details of the authenticated user via the Esp.user.name and the Esp.user.abilities properties.</li>
                <li>The Esp service wraps the Angular http service and intercepts responses to provide uniform error handling. Responses with a 401 HTTP_UNAUTHORIZED status code are handled with the browser redirected to the login page defined by the "settings.loginRequired" value.</li>
                <li>The Esp service provides a checkAuth routine that can be called when resolving routes. This routine tests if the authenticated user has the requisite abilities to be granted access.</li>
            </ul>
            <p>The ESP service may be injected by Angular client code to provide access to ESP in the client.
            The ESP service is also aliased in the Angular $rootScope as "Esp".
            <h3>EspResource Service</h3>
            <p>The EspResource supports RESTful HTTP requests to ESP applications.
                The EspResource factory is used to create resource objects that interact with the server via RESTful HTTP requests. EspResource is typically used to create a resource object for each data model. Consider the example below that creates a resource group for users. This creates routes for the standard restful routes of: create, edit, init, list, remove and update, as well as creating custom routes for forgot, login and logout. Each of these routes is represented by a function that can be called to issue the corresponding HTTP RESTful request.
            <h3>SessionStore</h3>
            <p>The SessionStore service object that provides access to client session storage using the 
            Javascript window.sessionStorage API. </p>
            <h3>esp-click</h3>
            <p>The esp-click directive can be used on elements instead of "href". This will conditionally redirect the 
            user to a link if the user has the required abilities. Abilities are defined in the configured 
            authentication store.</p>
            <h3>esp-field-errors</h3>
            <p>The esp-field-errors directive displays form validation errors returned from the server.</p>
            <h3>esp-input</h3>
            <p>This directive generates appropriate HTML input, textarea, checkbox, radio or select elements based
            on the field data type.</p>
            <h3>esp-input-group</h3>
            <p>This directive generates a set of appropriate HTML input elemetns based on the types of the input
            fields in a record.</p>
            <h3>esp-titlecase</h2>
            <p>The esp-titlecase filter capitalizes the first letter of each word.</p>
            <h3>format</h3>
            <p>The format filter transforms data to be displayed to the required format. This can be used to 
            tailor the way dates and numbers are displayed.</p>
            <h2>User Authentication and Permissions</h2>
                - User database table vs other stores
                - User roles
                - Restricting access on the client side
                - 
            <h2>Hosting</h2>
            <p>Applications created via the <em>esp</em> generator will have a <em>hosted.conf</em> file. This may
            be modified to suit and then be included from an existing appweb.conf to host.</p>
            <pre>include /path/to/hosted.conf </pre>
            <h2>ESP Angular API</h2>
            <p>For full details of the ESP Angular APIs, see <a href="../../../api/esp-angular/index.html">ESP Angular API</a>.</p>
            <h2>Samples</h2>
            <p>The appweb source code includes a large set of samples that demonstrate many uses of ESP. See
            the samples at <a href="https://github.com/embedthis/appweb/tree/dev/samples">Appweb Samples</a>.
            For an Angular specific sample, see:
            <a href="https://github.com/embedthis/appweb/tree/dev/samples/esp-angular-mvc">ESP Angular MVC</a>.
            <h2>Angular Resources</h2>
            <p>Here are some useful resource to learn about Angular.</p>
            <ul>
                <li><a href="http://angularjs.org">angular.org</a> &mdash; The official Angular web site</li>
                <li><a href="http://goo.gl/VGkz8E">AngularJS End to End</a> &mdash; AngularJS Overview Presentation</li>
                <li><a href="http://www.youtube.com/user/angularjs">www.youtube.com/user/angularjs</a> &mdash; The official Angular youtube channel</li>
                <li><a href="http://blog.angularjs.org">blog.angularjs.org</a> &mdash; The official Angular blog</li>
                <li><a href="https://plus.google.com/+AngularJS/posts">plus.google.com/+AngularJS</a> &mdash; Angular Google+ Page</li>
                <li><a href="http://egghead.io">egghead.io</a> &mdash; AngularJS Videos and Tutorials</li>
                <li><a href="http://docs.angularjs.org">docs.angularjs.org</a> &mdash; AngularJS Documentation</li>
                <li><a href="http://en.wikipedia.org/wiki/AngularJS">en.wikipedia.org/wiki/AngularJS</a> &mdash; Wikipedia Angular article</li>
            </ul>
        </div>
    </div>
<!-- BeginDsi "dsi/bottom.html" -->
	<div class="bottom">
		<p class="footnote"> 
            <a href="../../../product/copyright.html" >&copy; Embedthis Software LLC, 2003-2014.
            All rights reserved. Embedthis, Appweb, ESP, Ejscript and Embedthis GoAhead are trademarks of Embedthis Software LLC.</a>
		</p>
	</div>
</body>
</html>
